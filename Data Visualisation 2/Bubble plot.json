{
  "$schema": "https://vega.github.io/schema/vega-lite/v4.json",
  "width": 800,
  "height": 600,
  "title": "GDP per capita and Happiness Score by country",
  "data": {
    "url": "https://raw.githubusercontent.com/dunyongtan/FIT3179/main/Choropleth_map/data/2020.csv"
  },
  "params": [
    {
      "name": "Region_selection",
      "bind": {
        "input": "select",
        "options": [
          null,
          "Central and Eastern Europe",
          "Commonwealth of Independent States",
          "East Asia",
          "Latin America and Caribbean",
          "Middle East and North Africa",
          "North America and ANZ",
          "South Asia",
          "South East Asia",
          "Sub-Saharan Africa",
          "Western Europe"
        ],
        "labels": [
          "Show All",
          "Central and Eastern Europe",
          "Commonwealth of Independent States",
          "East Asia",
          "Latin America and Caribbean",
          "Middle East and North Africa",
          "North America and ANZ",
          "South Asia",
          "South East Asia",
          "Sub-Saharan Africa",
          "Western Europe"
        ],
        "name": "Region Selection: "
      }
    }
  ],
  "transform": [
    {"filter": "Region_selection == null || datum.Region == Region_selection"}
  ],
  "encoding": {
    "x": {
      "field": "HappinessScore",
      "type": "quantitative",
      "title": "Happiness Score",
      "axis": {"tickCount": 7},
      "scale": {"type": "linear", "domain": [2, 8]}
    },
    "y": {
      "field": "LoggedGDPpercapita",
      "type": "quantitative",
      "title": "GDP (per capita)",
      "axis": {"tickCount": 7},
      "scale": {"type": "linear", "domain": [6, 12]}
    }
  },
  "layer": [
    {
      "selection": {
        "region_select": {
          "type": "multi",
          "fields": ["Region"],
          "bind": "legend"
        }
      },
      "mark": "circle",
      "encoding": {
        "size": {
          "field": "Healthy life expectancy",
          "type": "quantitative",
          "scale": {
            "type": "threshold",
            "domain": [40, 50, 60, 70],
            "range": [10, 150, 300, 500, 700]
          },
          "legend": {"format": ".1s"}
        },
        "color": {
          "field": "Region",
          "type": "nominal",
          "scale": {
            "domain": [
              "Central and Eastern Europe",
              "Commonwealth of Independent States",
              "East Asia",
              "Latin America and Caribbean",
              "Middle East and North Africa",
              "North America and ANZ",
              "South Asia",
              "South East Asia",
              "Sub-Saharan Africa",
              "Western Europe"
            ],
            "range": [
              "#a6cee3",
              "#1f78b4",
              "#b2df8a",
              "#a65628",
              "#fb9a99",
              "#e31a1c",
              "#fdbf6f",
              "#ff7f00",
              "#cab2d6",
              "#6a3d9a"
            ]
          }
        },
        "opacity": {
          "condition": {"selection": "region_select", "value": 0.8},
          "value": 0.2
        },
        "tooltip": [
          {"field": "Country", "type": "nominal"},
          {
            "field": "HappinessScore",
            "type": "quantitative",
            "title": "Happiness Score"
          },
          {
            "field": "LoggedGDPpercapita",
            "type": "quantitative",
            "title": "GDP (per capita)"
          }
        ]
      }
    },
    {
      "mark": {
        "type": "text",
        "align": "left",
        "baseline": "top",
        "fontSize": 11,
        "fontStyle": "italic",
        "dx": 12
      },
      "encoding": {
        "text": {"field": "Country", "type": "nominal"},
        "color": {"value": "black"},
        "opacity": {
          "condition": {
            "test": "datum['Country'] == 'Australia' || datum['Country'] == 'Singapore'  || datum['Country'] == 'Syria' || datum['Country'] == 'China'|| datum['Country'] == 'Czech Republic'|| datum['Country'] == 'Denmark' || datum['Country'] == 'New Zealand' ",
            "value": 1
          },
          "value": 0
        },
        "tooltip": [
          {"field": "Country", "type": "nominal"},
          {
            "field": "HappinessRank",
            "type": "quantitative",
            "title": "Happiness Rank"
          },
          {
            "field": "HappinessScore",
            "type": "quantitative",
            "title": "Happiness Score"
          },
          {
            "field": "LoggedGDPpercapita",
            "type": "quantitative",
            "title": "GDP (per capita)"
          },
          {
            "field": "Healthy life expectancy",
            "type": "quantitative",
            "title": "Healthy life expectancy"
          }
        ]
      }
    }
  ],
  "config": {}
}